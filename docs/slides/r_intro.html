<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <title>Duh 165 Applied Statistics - Friday lecture – Part 1: R, Rstudio and other tools</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="missplot.png" data-background-opacity="0.5" data-background-size="stretch" class="quarto-title-block center">
  <h1 class="title">Part 1: R, Rstudio and other tools</h1>

<div class="quarto-title-authors">
</div>

</section>
<section>
<section id="rstudio-intro" class="title-slide slide level1 center">
<h1>Rstudio intro</h1>

</section>
<section id="useful-tools-for-doing-research" class="slide level2">
<h2>Useful tools for doing research</h2>
<ul>
<li>Rstudio to do statistics</li>
<li>Latex, e.g., Overleaf to write APA7 compliant papers</li>
<li>Use Google scholar to collect references in bibtex format</li>
<li>Use e.g.&nbsp;<em>xtable</em> package in R to generate Tables (Or AI LLMs)</li>
<li>Use <em>ggplot</em> package to generate graphics</li>
</ul>
<p>Let us use the dataset “bigfive.csv” in this session to illustrate.</p>
<p>-Download dataset and open in Rstudio, using <em>File&gt;Import dataset</em> -how many variables? how many observations? -run <em>summary()</em> on the dataframe - look at the missing data structure: <em>naniar</em> package, <em>vis_miss()</em> function</p>
</section>
<section id="inspecting-data-descriptives-using-gtsummary-package" class="slide level2">
<h2>Inspecting data: descriptives using gtsummary package</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a>mydata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/bigfive.csv"</span>)</span>
<span id="cb1-2"><a></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-3"><a></a>mydata <span class="sc">%&gt;%</span> <span class="fu">tbl_summary</span>(<span class="at">by =</span> gender, <span class="at">missing_text=</span><span class="st">"missing"</span>,</span>
<span id="cb1-4"><a></a>              <span class="at">statistic =</span> <span class="fu">list</span>(<span class="fu">all_continuous</span>() <span class="sc">~</span> <span class="st">"{mean} ({sd})"</span>)) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="wvuahajfaw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#wvuahajfaw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#wvuahajfaw thead, #wvuahajfaw tbody, #wvuahajfaw tfoot, #wvuahajfaw tr, #wvuahajfaw td, #wvuahajfaw th {
  border-style: none;
}

#wvuahajfaw p {
  margin: 0;
  padding: 0;
}

#wvuahajfaw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#wvuahajfaw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#wvuahajfaw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#wvuahajfaw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#wvuahajfaw .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wvuahajfaw .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wvuahajfaw .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#wvuahajfaw .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#wvuahajfaw .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#wvuahajfaw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#wvuahajfaw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#wvuahajfaw .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#wvuahajfaw .gt_spanner_row {
  border-bottom-style: hidden;
}

#wvuahajfaw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#wvuahajfaw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#wvuahajfaw .gt_from_md > :first-child {
  margin-top: 0;
}

#wvuahajfaw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#wvuahajfaw .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#wvuahajfaw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#wvuahajfaw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#wvuahajfaw .gt_row_group_first td {
  border-top-width: 2px;
}

#wvuahajfaw .gt_row_group_first th {
  border-top-width: 2px;
}

#wvuahajfaw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvuahajfaw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#wvuahajfaw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#wvuahajfaw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wvuahajfaw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvuahajfaw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#wvuahajfaw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#wvuahajfaw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#wvuahajfaw .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#wvuahajfaw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wvuahajfaw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvuahajfaw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#wvuahajfaw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#wvuahajfaw .gt_left {
  text-align: left;
}

#wvuahajfaw .gt_center {
  text-align: center;
}

#wvuahajfaw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#wvuahajfaw .gt_font_normal {
  font-weight: normal;
}

#wvuahajfaw .gt_font_bold {
  font-weight: bold;
}

#wvuahajfaw .gt_font_italic {
  font-style: italic;
}

#wvuahajfaw .gt_super {
  font-size: 65%;
}

#wvuahajfaw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#wvuahajfaw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#wvuahajfaw .gt_indent_1 {
  text-indent: 5px;
}

#wvuahajfaw .gt_indent_2 {
  text-indent: 10px;
}

#wvuahajfaw .gt_indent_3 {
  text-indent: 15px;
}

#wvuahajfaw .gt_indent_4 {
  text-indent: 20px;
}

#wvuahajfaw .gt_indent_5 {
  text-indent: 25px;
}

#wvuahajfaw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#wvuahajfaw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="stat_1" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>F</strong><br>
N = 248<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="stat_2" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>M</strong><br>
N = 252<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">x1</td>
<td class="gt_row gt_center" headers="stat_1">0.86 (1.04)</td>
<td class="gt_row gt_center" headers="stat_2">-0.68 (1.01)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">3</td>
<td class="gt_row gt_center" headers="stat_2">3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x2</td>
<td class="gt_row gt_center" headers="stat_1">0.86 (0.99)</td>
<td class="gt_row gt_center" headers="stat_2">-0.87 (1.02)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">4</td>
<td class="gt_row gt_center" headers="stat_2">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x3</td>
<td class="gt_row gt_center" headers="stat_1">0.91 (1.03)</td>
<td class="gt_row gt_center" headers="stat_2">-1.00 (1.05)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x4</td>
<td class="gt_row gt_center" headers="stat_1">0.18 (1.21)</td>
<td class="gt_row gt_center" headers="stat_2">-0.12 (1.21)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">3</td>
<td class="gt_row gt_center" headers="stat_2">3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x5</td>
<td class="gt_row gt_center" headers="stat_1">0.10 (1.63)</td>
<td class="gt_row gt_center" headers="stat_2">-0.18 (1.54)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x6</td>
<td class="gt_row gt_center" headers="stat_1">0.27 (1.49)</td>
<td class="gt_row gt_center" headers="stat_2">-0.36 (1.41)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">5</td>
<td class="gt_row gt_center" headers="stat_2">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x7</td>
<td class="gt_row gt_center" headers="stat_1">0.12 (1.16)</td>
<td class="gt_row gt_center" headers="stat_2">-0.06 (1.21)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">0</td>
<td class="gt_row gt_center" headers="stat_2">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x8</td>
<td class="gt_row gt_center" headers="stat_1">0.29 (1.58)</td>
<td class="gt_row gt_center" headers="stat_2">-0.27 (1.66)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">3</td>
<td class="gt_row gt_center" headers="stat_2">5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x9</td>
<td class="gt_row gt_center" headers="stat_1">0.24 (1.33)</td>
<td class="gt_row gt_center" headers="stat_2">-0.16 (1.37)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">5</td>
<td class="gt_row gt_center" headers="stat_2">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x10</td>
<td class="gt_row gt_center" headers="stat_1">-0.03 (1.71)</td>
<td class="gt_row gt_center" headers="stat_2">-0.21 (1.37)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x11</td>
<td class="gt_row gt_center" headers="stat_1">0.01 (1.10)</td>
<td class="gt_row gt_center" headers="stat_2">-0.07 (1.08)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">1</td>
<td class="gt_row gt_center" headers="stat_2">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x12</td>
<td class="gt_row gt_center" headers="stat_1">0.14 (1.30)</td>
<td class="gt_row gt_center" headers="stat_2">-0.17 (1.27)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">2</td>
<td class="gt_row gt_center" headers="stat_2">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x13</td>
<td class="gt_row gt_center" headers="stat_1">0.03 (1.25)</td>
<td class="gt_row gt_center" headers="stat_2">0.15 (1.24)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">2</td>
<td class="gt_row gt_center" headers="stat_2">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x14</td>
<td class="gt_row gt_center" headers="stat_1">-0.04 (1.37)</td>
<td class="gt_row gt_center" headers="stat_2">0.15 (1.60)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">2</td>
<td class="gt_row gt_center" headers="stat_2">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">x15</td>
<td class="gt_row gt_center" headers="stat_1">-0.16 (1.63)</td>
<td class="gt_row gt_center" headers="stat_2">0.12 (1.65)</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;missing</td>
<td class="gt_row gt_center" headers="stat_1">3</td>
<td class="gt_row gt_center" headers="stat_2">2</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="3" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> Mean (SD)</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
</section>
<section id="missing-data" class="slide level2">
<h2>Missing data!</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a></a>mydata <span class="ot">&lt;-</span> mydata[, <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>]<span class="co">#drop gender</span></span>
<span id="cb2-2"><a></a><span class="fu">library</span>(naniar) <span class="co"># visualize missingness</span></span>
<span id="cb2-3"><a></a><span class="fu">vis_miss</span>(mydata)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="r_intro_files/figure-revealjs/unnamed-chunk-3-1.png" width="960" class="r-stretch"><p>Missing data can be categorized into three main types: <strong>MCAR</strong>, <strong>MAR</strong>, and <strong>MNAR</strong>.</p>
</section>
<section id="missing-completely-at-random-mcar" class="slide level2">
<h2>Missing Completely at Random (MCAR)</h2>
<p>When data are MCAR, missingness is unrelated to both observed and unobserved data, meaning no systematic differences exist between those with and without missing values.</p>
<p><strong>Example:</strong> Lab samples are lost due to a processing error. MCAR reduces sample size but does not introduce bias. However, it is a strong and often unrealistic assumption.</p>
</section>
<section id="missing-at-random-mar" class="slide level2">
<h2>Missing at Random (MAR)</h2>
<p>When data are MAR, missingness depends on observed data but not on the missing values themselves.</p>
<p><strong>Example:</strong> In a depression study, men may be less likely to complete a survey, but missingness is unrelated to depression severity. Complete case analysis may be biased, but adjusting for observed factors (e.g., sex) can correct this.</p>
<p>The <em>fiml</em> estimator in lavaan is commonly used to handle missingness, under the assumption of R. Full-information means that we do not throw away any data points. Using the default estimator means listwise deletion.</p>
</section>
<section id="missing-not-at-random-mnar" class="slide level2">
<h2>Missing Not at Random (MNAR)</h2>
<p>When data are MNAR, missingness is related to unobserved data, meaning the reason for missing data is itself unknown.</p>
<p><strong>Example:</strong> People with severe depression may be less likely to complete a survey. Because the cause of missingness is unmeasured, bias is likely and difficult to correct.</p>
</section>
<section id="look-at-the-distributions-all-15-at-once-normally-distributed-all-very-unrealistic" class="slide level2">
<h2>Look at the distributions all 15 at once, normally distributed all (very unrealistic!)</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="fu">library</span>(tidyverse)<span class="co"># a bundle of packages, with ggplot included</span></span>
<span id="cb3-2"><a></a><span class="co">#wide to long format. PIPING operator!</span></span>
<span id="cb3-3"><a></a>long <span class="ot">&lt;-</span> mydata <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="fu">everything</span>())</span>
<span id="cb3-4"><a></a><span class="fu">ggplot</span>(long, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb3-5"><a></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb3-6"><a></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> name) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="r_intro_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="confirmatory-factor-analysis" class="title-slide slide level1 center">
<h1>Confirmatory Factor Analysis</h1>

</section>
<section id="the-correlation-matrix-has-patterns.." class="slide level2">
<h2>The correlation matrix has patterns..</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a></a>psych<span class="sc">::</span><span class="fu">cor.plot</span>(mydata)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

</div>
<img data-src="r_intro_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="the-five-factor-model" class="slide level2">
<h2>The Five factor Model</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a>model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb5-2"><a></a><span class="st">F1 =~ x1 + x2 + x3</span></span>
<span id="cb5-3"><a></a><span class="st">F2 =~ x4 + x5 + x6</span></span>
<span id="cb5-4"><a></a><span class="st">F3 =~ x7 + x8 + x9</span></span>
<span id="cb5-5"><a></a><span class="st">F4 =~ x10 + x11 + x12</span></span>
<span id="cb5-6"><a></a><span class="st">F5 =~ x13 + x14 + x15"</span></span>
<span id="cb5-7"><a></a></span>
<span id="cb5-8"><a></a><span class="fu">library</span>(psych)<span class="co"># package with many psychometric functions</span></span>
<span id="cb5-9"><a></a></span>
<span id="cb5-10"><a></a><span class="co">#Reliability, i.e.,  cronbachs alpha</span></span>
<span id="cb5-11"><a></a>psych<span class="sc">::</span><span class="fu">alpha</span>(mydata[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])[[<span class="dv">1</span>]]<span class="co"># three first indicators</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> raw_alpha std.alpha  G6(smc) average_r      S/N        ase        mean
 0.7178031 0.7186151 0.630705 0.4598343 2.553851 0.02176864 0.004900656
       sd median_r
 1.075566 0.449559</code></pre>
</div>
</div>
</section>
<section id="let-us-fit-the-model-using-default-estimator-ml" class="slide level2">
<h2>Let us fit the model using default estimator “ML”</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">library</span>(lavaan)</span>
<span id="cb7-2"><a></a>f1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, <span class="at">data=</span>mydata)</span>
<span id="cb7-3"><a></a><span class="fu">summary</span>(f1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 48 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        40

                                                  Used       Total
  Number of observations                           430         500

Model Test User Model:
                                                      
  Test statistic                                62.560
  Degrees of freedom                                80
  P-value (Chi-square)                           0.925

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 =~                                               
    x1                1.000                           
    x2                1.139    0.120    9.517    0.000
    x3                1.202    0.126    9.528    0.000
  F2 =~                                               
    x4                1.000                           
    x5                1.460    0.154    9.491    0.000
    x6                1.416    0.149    9.509    0.000
  F3 =~                                               
    x7                1.000                           
    x8                2.156    0.274    7.875    0.000
    x9                1.412    0.173    8.172    0.000
  F4 =~                                               
    x10               1.000                           
    x11               0.486    0.070    6.927    0.000
    x12               0.656    0.091    7.173    0.000
  F5 =~                                               
    x13               1.000                           
    x14               1.731    0.189    9.170    0.000
    x15               2.168    0.245    8.848    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 ~~                                               
    F2                0.185    0.045    4.080    0.000
    F3                0.158    0.038    4.114    0.000
    F4                0.142    0.066    2.169    0.030
    F5               -0.057    0.033   -1.709    0.088
  F2 ~~                                               
    F3                0.009    0.030    0.299    0.765
    F4                0.283    0.065    4.332    0.000
    F5               -0.124    0.034   -3.657    0.000
  F3 ~~                                               
    F4                0.005    0.047    0.102    0.919
    F5               -0.114    0.029   -3.904    0.000
  F4 ~~                                               
    F5               -0.106    0.049   -2.165    0.030

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.934    0.088   10.594    0.000
   .x2                0.948    0.101    9.393    0.000
   .x3                0.998    0.110    9.099    0.000
   .x4                0.927    0.082   11.313    0.000
   .x5                1.276    0.137    9.291    0.000
   .x6                1.039    0.122    8.522    0.000
   .x7                1.028    0.081   12.626    0.000
   .x8                0.912    0.184    4.954    0.000
   .x9                1.123    0.108   10.364    0.000
   .x10               0.961    0.181    5.296    0.000
   .x11               0.898    0.075   12.052    0.000
   .x12               1.111    0.106   10.437    0.000
   .x13               1.146    0.086   13.277    0.000
   .x14               1.015    0.121    8.418    0.000
   .x15               0.764    0.162    4.712    0.000
    F1                0.661    0.107    6.165    0.000
    F2                0.564    0.095    5.928    0.000
    F3                0.367    0.076    4.798    0.000
    F4                1.340    0.221    6.057    0.000
    F5                0.398    0.080    5.007    0.000</code></pre>
</div>
</div>
</section>
<section id="fiml-uses-all-of-the-data-no-listwise-deletion" class="slide level2">
<h2>FIML uses all of the data (no listwise deletion)</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">library</span>(lavaan)</span>
<span id="cb9-2"><a></a>f2 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, <span class="at">data=</span>mydata, <span class="at">missing=</span><span class="st">"FIML"</span>)</span>
<span id="cb9-3"><a></a><span class="fu">summary</span>(f2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 49 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        55

  Number of observations                           500
  Number of missing patterns                        20

Model Test User Model:
                                                      
  Test statistic                                65.003
  Degrees of freedom                                80
  P-value (Chi-square)                           0.888

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 =~                                               
    x1                1.000                           
    x2                1.093    0.107   10.252    0.000
    x3                1.222    0.123    9.917    0.000
  F2 =~                                               
    x4                1.000                           
    x5                1.480    0.142   10.426    0.000
    x6                1.435    0.143   10.032    0.000
  F3 =~                                               
    x7                1.000                           
    x8                2.083    0.248    8.392    0.000
    x9                1.326    0.143    9.252    0.000
  F4 =~                                               
    x10               1.000                           
    x11               0.455    0.064    7.101    0.000
    x12               0.639    0.086    7.432    0.000
  F5 =~                                               
    x13               1.000                           
    x14               1.688    0.169   10.000    0.000
    x15               2.062    0.213    9.696    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 ~~                                               
    F2                0.163    0.041    3.959    0.000
    F3                0.169    0.038    4.438    0.000
    F4                0.154    0.063    2.440    0.015
    F5               -0.035    0.032   -1.091    0.275
  F2 ~~                                               
    F3               -0.008    0.029   -0.284    0.776
    F4                0.266    0.060    4.428    0.000
    F5               -0.128    0.033   -3.921    0.000
  F3 ~~                                               
    F4                0.002    0.047    0.038    0.970
    F5               -0.106    0.028   -3.783    0.000
  F4 ~~                                               
    F5               -0.110    0.049   -2.263    0.024

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.081    0.057    1.421    0.155
   .x2               -0.013    0.060   -0.214    0.831
   .x3               -0.050    0.063   -0.786    0.432
   .x4                0.029    0.055    0.530    0.596
   .x5               -0.038    0.071   -0.536    0.592
   .x6               -0.042    0.066   -0.626    0.532
   .x7                0.029    0.053    0.550    0.582
   .x8                0.009    0.074    0.120    0.905
   .x9                0.047    0.061    0.765    0.445
   .x10              -0.116    0.069   -1.675    0.094
   .x11              -0.032    0.049   -0.663    0.507
   .x12              -0.014    0.058   -0.239    0.811
   .x13               0.086    0.056    1.531    0.126
   .x14               0.055    0.067    0.829    0.407
   .x15              -0.020    0.074   -0.270    0.788

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.949    0.085   11.145    0.000
   .x2                0.945    0.091   10.354    0.000
   .x3                0.985    0.106    9.262    0.000
   .x4                0.914    0.076   12.040    0.000
   .x5                1.285    0.132    9.713    0.000
   .x6                1.029    0.118    8.712    0.000
   .x7                1.000    0.077   12.941    0.000
   .x8                0.902    0.179    5.035    0.000
   .x9                1.137    0.101   11.245    0.000
   .x10               1.007    0.182    5.526    0.000
   .x11               0.900    0.068   13.160    0.000
   .x12               1.095    0.099   11.034    0.000
   .x13               1.127    0.080   14.010    0.000
   .x14               0.994    0.115    8.617    0.000
   .x15               0.862    0.153    5.634    0.000
    F1                0.677    0.103    6.564    0.000
    F2                0.565    0.089    6.375    0.000
    F3                0.412    0.077    5.327    0.000
    F4                1.375    0.219    6.282    0.000
    F5                0.431    0.078    5.542    0.000</code></pre>
</div>
</div>
</section>
<section id="latent-variable-models-vs-meansum-scores." class="slide level2">
<h2>Latent variable models vs mean/sum scores.</h2>
<p>Let us estimate the correlation betweeen F1 and F2 in the CFA model</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="fu">standardizedsolution</span>(f1)[<span class="dv">36</span>,]<span class="co"># look at correlation F1 and F2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   lhs op rhs est.std    se     z pvalue ci.lower ci.upper
36  F1 ~~  F2   0.304 0.063 4.844      0    0.181    0.427</code></pre>
</div>
</div>
<p>The naive and much simpler approach is to use <em>sum/mean scores</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a>s1 <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(mydata[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">na.rm=</span>T)</span>
<span id="cb13-2"><a></a>s2 <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(mydata[, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>], <span class="at">na.rm=</span>T)</span>
<span id="cb13-3"><a></a><span class="fu">plot</span>(s1, s2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>

<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a></a><span class="fu">cor</span>(s1,s2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1828778</code></pre>
</div>
</div>
<img data-src="r_intro_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"><p>The association is <em>attenuated</em> using naiv sum scores!</p>
</section>
<section id="goodness-of-fit-how-well-does-the-model-fit-the-data" class="slide level2">
<h2>Goodness-of-fit: How well does the model fit the data?</h2>
<p>The strict test for model fit is the chi-square test. The null hypothesis: The model is correctly specified. The alternative hypothesis: The model is misspecified!</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a></a><span class="fu">fitmeasures</span>(f1, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"df"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq pvalue     df 
62.560  0.925 80.000 </code></pre>
</div>
</div>
<p>pvalue is just the upper tail in a chi-square distribution</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a></a><span class="fu">pchisq</span>(<span class="fl">62.56</span>, <span class="at">df =</span> <span class="dv">80</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9251002</code></pre>
</div>
</div>
<p>The null is not rejected! A very well-fitting model (totally unrealistic)</p>
</section>
<section id="degrees-of-freedom-in-latent-variable-models" class="slide level2">
<h2>Degrees of freedom in latent variable models</h2>
<p>Degrees: The number of variances and covariances among the 15 observed indicators, minus the number of free model parameters.</p>
<ul>
<li>There are 15*16/2=120 variances/covariances</li>
<li>There are 2<em>5 factor loadings, 15 residual variances, and 5</em>6/2=15 latent variances/covariances.</li>
<li>Total number of free parameters is 10+15+15=40</li>
<li>DF = 120-40=80</li>
</ul>
</section>
<section id="the-p-value" class="slide level2">
<h2>The p-value</h2>

<img data-src="r_intro_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"></section>
<section id="what-to-do-with-non-normal-data" class="slide level2">
<h2>What to do with non-normal data?</h2>
<ul>
<li><p>Data is seldom normal (either skewed, or ordinal in nature- Likert data).</p></li>
<li><p>We then need a scaled chi-square test, and robust standard errors. The classical way is to use “MLM” estimator. Gives robust standard errors and a scaled Satorra-Bentler statistic.</p></li>
</ul>
<p>Exercises:</p>
<ul>
<li>Download and open the dataset bigfive_nonnormal.cvs</li>
<li>check skewness and kurtosis on the marginals using psych::skew, and psych::kurtosi</li>
<li>Estimate the model using estimator=“MLM” in <em>cfa()</em> function</li>
</ul>
</section>
<section id="recent-findings-concerning-the-chi-square-test-normal-data" class="slide level2">
<h2>Recent findings concerning the chi-square test: Normal data</h2>
<p>Normal data: The default in mplus and lavaan is the ML chi-square. A much better fit statistic is Brownes residual-based statistic. See <em>Foldnes, N., Moss, J., &amp; Grønneberg, S. (2025). Improved Goodness of Fit Procedures for Structural Equation Models. Structural Equation Modeling</em>. Available in package semTests:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a></a>semTests<span class="sc">::</span><span class="fu">pvalues</span>(f1, <span class="at">tests=</span><span class="fu">c</span>(<span class="st">"std_rls"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  std_rls 
0.9390634 </code></pre>
</div>
</div>
</section>
<section id="recent-findings-concerning-the-chi-square-test-non-normal-data" class="slide level2">
<h2>Recent findings concerning the chi-square test: Non-normal data</h2>
<ul>
<li>Non-normal data. The much used Satorra-Bentler test is outperformed by newer test statistics available in package semTests</li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a></a><span class="fu">library</span>(semTests)</span>
<span id="cb22-2"><a></a>skeweddata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/bigfive_nonnormal.csv"</span>)</span>
<span id="cb22-3"><a></a>f <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, skeweddata, <span class="at">estimator=</span><span class="st">"MLM"</span>)</span>
<span id="cb22-4"><a></a><span class="fu">fitmeasures</span>(f, <span class="st">"pvalue.robust"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>numeric(0)</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a>semTests<span class="sc">::</span><span class="fu">pvalues</span>(f1)<span class="co">#peba4_rls is the overall winner in an upcoming BRM paper!</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>peba4_rls 
0.9185683 </code></pre>
</div>
</div>
</section>
<section id="a-real-world-dataset" class="slide level2">
<h2>A real-world dataset</h2>
<p>More often than not, the chi-square test will reject the model.</p>
<p>A real-world dataset: <em>bfi</em> in psych package</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a>f <span class="ot">&lt;-</span> <span class="fu">cfa</span>(<span class="st">"E=~E1+E2+E3+E4+E5"</span>, bfi, <span class="at">estimator=</span><span class="st">"MLM"</span>)</span>
<span id="cb26-2"><a></a><span class="fu">fitmeasures</span>(f, <span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"pvalue"</span>, <span class="st">"df"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq pvalue     df 
86.601  0.000  5.000 </code></pre>
</div>
</div>
<p>Clearly, the model is misspecified! But can it still be used?</p>
</section>
<section id="fit-indices" class="slide level2">
<h2>Fit indices</h2>
<p>Then we have “tests” of “approximate fit”. These are fit indices and are not statistically motivated, but involve “rules of thumb”. Papers typically cite Hu&amp;Bentler 1999 or some textbook for cutoffs.</p>
<p>-RMSEA (should be below .08? or .05?) -CFI -SRMR</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a></a><span class="fu">fitmeasures</span>(f, <span class="fu">c</span>(<span class="st">"rmsea.robust"</span>, <span class="st">"cfi.robust"</span>, <span class="st">"srmr"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>rmsea.robust   cfi.robust         srmr 
       0.077        0.973        0.030 </code></pre>
</div>
</div>
</section>
<section id="what-about-likert-data-this-is-the-most-frequent-type-of-dataset" class="slide level2">
<h2>What about Likert data (this is the most frequent type of dataset)</h2>
<p>Let us discretize the data into 1-5 scale Likert data</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a></a>likert <span class="ot">&lt;-</span> <span class="fu">sapply</span>(mydata, cut, <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span>.<span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="cn">Inf</span>), <span class="at">labels=</span>F) <span class="co">#chop into discrete values</span></span>
<span id="cb30-2"><a></a>likert <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(likert)</span>
<span id="cb30-3"><a></a><span class="fu">head</span>(likert)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  x1 x2 x3 x4 x5 x6 x7 x8 x9 x10 x11 x12 x13 x14 x15
1  5  4  5  4  5  4  2  1  1   1   5   2   5   4   5
2  4  4  4  4  2  5  5  4  1   2   5   5   1   1   1
3  5  4  1  1  1  1  1  4  4   2   2   2   1   3   5
4  3  5  4  4  1  1  1  1  2   1   3   3   5   2   3
5  1  3  2  1  1  1  2  1  2   5   4   2   4   5   5
6  3  2  3  4  4  5  3  1  4   1   4   3   4   3   5</code></pre>
</div>
</div>
</section>
<section id="option-1-treating-data-as-continuous" class="slide level2">
<h2>Option 1: Treating data as continuous</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a>fcont <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, likert, <span class="at">estimator=</span><span class="st">"MLM"</span>)<span class="co">#needed for Likert data</span></span>
<span id="cb32-2"><a></a><span class="fu">summary</span>(fcont)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 56 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        40

                                                  Used       Total
  Number of observations                           430         500

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                63.435      63.793
  Degrees of freedom                                80          80
  P-value (Chi-square)                           0.913       0.908
  Scaling correction factor                                  0.994
    Satorra-Bentler correction                                    

Parameter Estimates:

  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 =~                                               
    x1                1.000                           
    x2                1.190    0.147    8.112    0.000
    x3                1.160    0.134    8.678    0.000
  F2 =~                                               
    x4                1.000                           
    x5                1.264    0.148    8.554    0.000
    x6                1.165    0.137    8.531    0.000
  F3 =~                                               
    x7                1.000                           
    x8                1.596    0.220    7.270    0.000
    x9                1.234    0.167    7.384    0.000
  F4 =~                                               
    x10               1.000                           
    x11               0.645    0.096    6.713    0.000
    x12               0.872    0.126    6.946    0.000
  F5 =~                                               
    x13               1.000                           
    x14               1.566    0.196    7.986    0.000
    x15               1.917    0.255    7.529    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 ~~                                               
    F2                0.224    0.054    4.149    0.000
    F3                0.186    0.052    3.580    0.000
    F4                0.180    0.067    2.707    0.007
    F5               -0.066    0.040   -1.660    0.097
  F2 ~~                                               
    F3                0.011    0.044    0.239    0.811
    F4                0.295    0.069    4.284    0.000
    F5               -0.135    0.042   -3.181    0.001
  F3 ~~                                               
    F4               -0.002    0.054   -0.035    0.972
    F5               -0.153    0.040   -3.805    0.000
  F4 ~~                                               
    F5               -0.105    0.050   -2.092    0.036

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                1.326    0.119   11.158    0.000
   .x2                1.225    0.144    8.511    0.000
   .x3                1.311    0.136    9.611    0.000
   .x4                1.316    0.108   12.158    0.000
   .x5                1.304    0.155    8.419    0.000
   .x6                1.336    0.140    9.511    0.000
   .x7                1.576    0.114   13.763    0.000
   .x8                1.176    0.186    6.312    0.000
   .x9                1.394    0.143    9.715    0.000
   .x10               1.227    0.167    7.352    0.000
   .x11               1.457    0.104   13.988    0.000
   .x12               1.330    0.144    9.238    0.000
   .x13               1.671    0.105   15.980    0.000
   .x14               1.270    0.148    8.559    0.000
   .x15               0.929    0.182    5.109    0.000
    F1                0.708    0.125    5.661    0.000
    F2                0.715    0.120    5.980    0.000
    F3                0.527    0.114    4.641    0.000
    F4                1.052    0.177    5.940    0.000
    F5                0.440    0.098    4.473    0.000</code></pre>
</div>
</div>
</section>
<section id="option-2-treating-data-as-ordinal" class="slide level2">
<h2>Option 2: Treating data as ordinal</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>ford <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, likert, <span class="at">ordered=</span><span class="cn">TRUE</span>)<span class="co">#needed for Likert data</span></span>
<span id="cb34-2"><a></a><span class="fu">summary</span>(ford)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6.17 ended normally after 47 iterations

  Estimator                                       DWLS
  Optimization method                           NLMINB
  Number of model parameters                        85

                                                  Used       Total
  Number of observations                           430         500

Model Test User Model:
                                              Standard      Scaled
  Test Statistic                                45.692      68.825
  Degrees of freedom                                80          80
  P-value (Chi-square)                           0.999       0.809
  Scaling correction factor                                  0.847
  Shift parameter                                           14.864
    simple second-order correction                                

Parameter Estimates:

  Parameterization                               Delta
  Standard errors                           Robust.sem
  Information                                 Expected
  Information saturated (h1) model        Unstructured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 =~                                               
    x1                1.000                           
    x2                1.117    0.126    8.853    0.000
    x3                1.059    0.114    9.248    0.000
  F2 =~                                               
    x4                1.000                           
    x5                1.136    0.136    8.358    0.000
    x6                1.218    0.140    8.712    0.000
  F3 =~                                               
    x7                1.000                           
    x8                1.445    0.178    8.123    0.000
    x9                1.116    0.136    8.179    0.000
  F4 =~                                               
    x10               1.000                           
    x11               0.732    0.113    6.494    0.000
    x12               0.964    0.140    6.892    0.000
  F5 =~                                               
    x13               1.000                           
    x14               1.346    0.154    8.729    0.000
    x15               1.640    0.200    8.211    0.000

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  F1 ~~                                               
    F2                0.126    0.029    4.302    0.000
    F3                0.116    0.029    3.948    0.000
    F4                0.095    0.035    2.733    0.006
    F5               -0.044    0.024   -1.808    0.071
  F2 ~~                                               
    F3                0.011    0.025    0.430    0.667
    F4                0.149    0.034    4.447    0.000
    F5               -0.081    0.024   -3.352    0.001
  F3 ~~                                               
    F4               -0.006    0.029   -0.218    0.827
    F5               -0.093    0.023   -3.942    0.000
  F4 ~~                                               
    F5               -0.067    0.028   -2.425    0.015

Thresholds:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
    x1|t1            -0.867    0.070  -12.464    0.000
    x1|t2            -0.518    0.064   -8.146    0.000
    x1|t3            -0.058    0.061   -0.963    0.335
    x1|t4             0.730    0.067   10.942    0.000
    x2|t1            -0.708    0.066  -10.667    0.000
    x2|t2            -0.388    0.062   -6.245    0.000
    x2|t3            -0.052    0.061   -0.867    0.386
    x2|t4             0.769    0.067   11.396    0.000
    x3|t1            -0.686    0.066  -10.391    0.000
    x3|t2            -0.339    0.062   -5.481    0.000
    x3|t3             0.000    0.061    0.000    1.000
    x3|t4             0.761    0.067   11.305    0.000
    x4|t1            -0.801    0.068  -11.756    0.000
    x4|t2            -0.446    0.063   -7.103    0.000
    x4|t3             0.023    0.061    0.385    0.700
    x4|t4             0.842    0.069   12.201    0.000
    x5|t1            -0.621    0.065   -9.556    0.000
    x5|t2            -0.284    0.061   -4.618    0.000
    x5|t3             0.029    0.061    0.482    0.630
    x5|t4             0.649    0.065    9.928    0.000
    x6|t1            -0.656    0.065  -10.021    0.000
    x6|t2            -0.290    0.061   -4.714    0.000
    x6|t3             0.105    0.061    1.734    0.083
    x6|t4             0.730    0.067   10.942    0.000
    x7|t1            -0.785    0.068  -11.576    0.000
    x7|t2            -0.363    0.062   -5.863    0.000
    x7|t3             0.047    0.061    0.771    0.441
    x7|t4             0.809    0.068   11.845    0.000
    x8|t1            -0.586    0.064   -9.088    0.000
    x8|t2            -0.296    0.061   -4.810    0.000
    x8|t3             0.017    0.061    0.289    0.773
    x8|t4             0.606    0.065    9.369    0.000
    x9|t1            -0.793    0.068  -11.666    0.000
    x9|t2            -0.363    0.062   -5.863    0.000
    x9|t3             0.000    0.061    0.000    1.000
    x9|t4             0.700    0.066   10.575    0.000
    x10|t1           -0.642    0.065   -9.835    0.000
    x10|t2           -0.235    0.061   -3.850    0.000
    x10|t3            0.076    0.061    1.252    0.210
    x10|t4            0.817    0.068   11.935    0.000
    x11|t1           -0.884    0.070  -12.639    0.000
    x11|t2           -0.388    0.062   -6.245    0.000
    x11|t3            0.035    0.061    0.578    0.563
    x11|t4            0.955    0.072   13.322    0.000
    x12|t1           -0.801    0.068  -11.756    0.000
    x12|t2           -0.339    0.062   -5.481    0.000
    x12|t3            0.029    0.061    0.482    0.630
    x12|t4            0.777    0.068   11.486    0.000
    x13|t1           -0.785    0.068  -11.576    0.000
    x13|t2           -0.426    0.063   -6.818    0.000
    x13|t3           -0.023    0.061   -0.385    0.700
    x13|t4            0.785    0.068   11.576    0.000
    x14|t1           -0.730    0.067  -10.942    0.000
    x14|t2           -0.414    0.062   -6.627    0.000
    x14|t3           -0.082    0.061   -1.349    0.177
    x14|t4            0.586    0.064    9.088    0.000
    x15|t1           -0.586    0.064   -9.088    0.000
    x15|t2           -0.345    0.062   -5.576    0.000
    x15|t3           -0.023    0.061   -0.385    0.700
    x15|t4            0.565    0.064    8.806    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .x1                0.579                           
   .x2                0.475                           
   .x3                0.528                           
   .x4                0.638                           
   .x5                0.533                           
   .x6                0.463                           
   .x7                0.689                           
   .x8                0.352                           
   .x9                0.613                           
   .x10               0.521                           
   .x11               0.744                           
   .x12               0.555                           
   .x13               0.729                           
   .x14               0.509                           
   .x15               0.271                           
    F1                0.421    0.066    6.422    0.000
    F2                0.362    0.060    6.012    0.000
    F3                0.311    0.058    5.383    0.000
    F4                0.479    0.082    5.867    0.000
    F5                0.271    0.053    5.091    0.000</code></pre>
</div>
</div>
</section>
<section id="which-is-the-best-option" class="slide level2">
<h2>which is the best option?</h2>
<ul>
<li><p>Likert scale data is a very hard challenge to CFA/SEM.</p></li>
<li><p>If the underlying distribution which has been discretized is multivariate normal, then ordered=TRUE should be used.</p></li>
<li><p>But this rarely holds, as <em>discnorm::bootTest()</em> will show.</p></li>
<li><p>The best thing is to do both ways, and hope that the substantive conclusions are similar</p></li>
<li><p>If many indicators, one option is to <em>parcel</em>: make sum scores of subsets of indicators and use these as indicators. Often done in big-five research</p></li>
</ul>
<p><em>Foldnes, N., &amp; Grønneberg, S. (2022). The sensitivity of structural equation modeling with ordinal data to underlying non-normality and observed distributional forms. Psychological Methods</em></p>
</section>
<section id="exercises" class="slide level2">
<h2>Exercises</h2>
<ol type="1">
<li><p>find the correlation between F2 and F5 in the CFA. And what is the correlation using mean scores for F2 and F5? Is the mean score correlation attenuated wrt the factor correlation?</p></li>
<li><p>A smaller model is considered: It contains F1 F2 and F3 (9 indicators). Try to calculate the number of covariances and variances in the 9 indicators. And calculate the number of free parameters. What is the df?</p></li>
<li><p>Verify your df calculations by running the F1-F2-F3 model in lavaan.</p></li>
</ol>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/njaalf\.github\.io\/duh165\/");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>